"""empty message

Revision ID: 531f99631d46
Revises:
Create Date: 2024-11-14 17:13:57.599472

"""

from alembic import op
import sqlalchemy as sa


# revision identifiers, used by Alembic.
revision = "531f99631d46"
down_revision = None
branch_labels = None
depends_on = None


def upgrade():
    # ### commands auto generated by Alembic - please adjust! ###
    op.create_table(
        "cameras",
        sa.Column("id", sa.String(), nullable=False),
        sa.Column("ip_address", sa.String(length=45), nullable=False),
        sa.Column("location", sa.String(length=120), nullable=False),
        sa.Column("confidence_threshold", sa.Float(), nullable=False),
        sa.Column("schedule", sa.String(), nullable=True),
        sa.PrimaryKeyConstraint("id"),
    )
    op.create_table(
        "users",
        sa.Column("id", sa.UUID(), nullable=False),
        sa.Column("username", sa.String(length=80), nullable=False),
        sa.Column("password_hash", sa.String(length=128), nullable=False),
        sa.Column(
            "role",
            sa.Enum("OPERATOR", "MANAGER", "ADMIN", "GUARD", name="userrole"),
            nullable=False,
        ),
        sa.Column("email", sa.String(length=120), nullable=False),
        sa.Column("created_at", sa.DateTime(), nullable=True),
        sa.PrimaryKeyConstraint("id"),
        sa.UniqueConstraint("email"),
        sa.UniqueConstraint("username"),
    )
    op.create_table(
        "alarms",
        sa.Column("id", sa.UUID(), nullable=False),
        sa.Column("camera_id", sa.String(), nullable=False),
        sa.Column("type", sa.String(), nullable=False),
        sa.Column("confidence_score", sa.Float(), nullable=False),
        sa.Column("timestamp", sa.DateTime(), nullable=True),
        sa.Column("image_base64", sa.String(), nullable=True),
        sa.Column(
            "status",
            sa.Enum("PENDING", "NOTIFIED", "RESOLVED", "IGNORED", name="alarmstatus"),
            nullable=False,
        ),
        sa.Column("operator_id", sa.UUID(), nullable=True),
        sa.Column("guard_id", sa.UUID(), nullable=True),
        sa.ForeignKeyConstraint(
            ["camera_id"],
            ["cameras.id"],
        ),
        sa.ForeignKeyConstraint(
            ["guard_id"],
            ["users.id"],
        ),
        sa.ForeignKeyConstraint(
            ["operator_id"],
            ["users.id"],
        ),
        sa.PrimaryKeyConstraint("id"),
    )
    op.create_table(
        "camera_control_actions",
        sa.Column("id", sa.UUID(), nullable=False),
        sa.Column("camera_id", sa.String(), nullable=False),
        sa.Column("initiated_by", sa.UUID(), nullable=False),
        sa.Column(
            "control_type",
            sa.Enum(
                "BRIGHTNESS", "ACTIVE_STATUS", "ZOOM_LEVEL", name="cameracontroltype"
            ),
            nullable=False,
        ),
        sa.Column("value", sa.String(), nullable=False),
        sa.Column("timestamp", sa.DateTime(), nullable=True),
        sa.ForeignKeyConstraint(
            ["camera_id"],
            ["cameras.id"],
        ),
        sa.ForeignKeyConstraint(
            ["initiated_by"],
            ["users.id"],
        ),
        sa.PrimaryKeyConstraint("id"),
    )
    # ### end Alembic commands ###


def downgrade():
    # ### commands auto generated by Alembic - please adjust! ###
    op.drop_table("camera_control_actions")
    op.drop_table("alarms")
    op.drop_table("users")
    op.drop_table("cameras")
    # ### end Alembic commands ###
